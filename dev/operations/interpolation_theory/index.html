<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Interpolation of Spherically Sampled Data · AntennaFieldRepresentations.jl</title><meta name="title" content="Interpolation of Spherically Sampled Data · AntennaFieldRepresentations.jl"/><meta property="og:title" content="Interpolation of Spherically Sampled Data · AntennaFieldRepresentations.jl"/><meta property="twitter:title" content="Interpolation of Spherically Sampled Data · AntennaFieldRepresentations.jl"/><meta name="description" content="Documentation for AntennaFieldRepresentations.jl."/><meta property="og:description" content="Documentation for AntennaFieldRepresentations.jl."/><meta property="twitter:description" content="Documentation for AntennaFieldRepresentations.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img class="docs-light-only" src="../../assets/logo.svg" alt="AntennaFieldRepresentations.jl logo"/><img class="docs-dark-only" src="../../assets/logo-dark.svg" alt="AntennaFieldRepresentations.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">AntennaFieldRepresentations.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Antenna Field Representations</span><ul><li><a class="tocitem" href="../../fieldrepresentations/">General Field Representation Interface</a></li><li><a class="tocitem" href="../../dipoles/dipole_representations/">Dipole Representations</a></li><li><a class="tocitem" href="../../spherical/spherical_representations/">Spherical Mode Representations</a></li><li><a class="tocitem" href="../../planewaves/planewave_representations/">Plane Wave Representations</a></li><li><a class="tocitem" href="../../surfacecurrents/surface_representations/">Equivalent Surface Currents</a></li></ul></li><li><span class="tocitem">Field Samplings</span><ul><li><a class="tocitem" href="../../sampling/fieldsamplings/">General Field Sampling Interface</a></li><li><a class="tocitem" href="../../sampling/irregularsampling/">Irregularly Distributed Field Samplings</a></li><li><a class="tocitem" href="../../sampling/sphericalsampling/">Spherical Field Samplings</a></li></ul></li><li><a class="tocitem" href="../../sampleddata/">Spherically Sampled Data Structures</a></li><li><span class="tocitem">Operations</span><ul><li><a class="tocitem" href="../operationmaps/">OperationMaps</a></li><li><a class="tocitem" href="../coordinate_trafos/">Coordinate Transformations</a></li><li><a class="tocitem" href="../conversions/">Conversion into Other Field Representations</a></li><li><a class="tocitem" href="../transmission/">Transmission</a></li><li><a class="tocitem" href="../interpolation/">Interpolation</a></li></ul></li><li><a class="tocitem" href="../../examples/">Examples</a></li><li><span class="tocitem">(Electromagnetic) Theory</span><ul><li><a class="tocitem" href="../../dipoles/dipole_theory/">Dipoles</a></li><li><a class="tocitem" href="../../spherical/spherical_theory/">Spherical Vector Wave Expansion</a></li><li><a class="tocitem" href="../../planewaves/planewave_theory/">Plane Wave Expansion</a></li><li><a class="tocitem" href="../../surfacecurrents/surface_theory/">Equivalent Surface Currents</a></li><li><input class="collapse-toggle" id="menuitem-7-5" type="checkbox"/><label class="tocitem" for="menuitem-7-5"><span class="docs-label">Fast Algorithms</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../spherical/spherical_fast/">Spherical Wacker Algorithm</a></li><li><a class="tocitem" href="../../mlfmm/mlfmm_theory/">Multilevel Fast Multipole Method</a></li></ul></li><li class="is-active"><a class="tocitem" href>Interpolation of Spherically Sampled Data</a><ul class="internal"><li><a class="tocitem" href="#Global-Interpolation"><span>Global Interpolation</span></a></li><li><a class="tocitem" href="#Local-Interpolation"><span>Local Interpolation</span></a></li></ul></li></ul></li><li><a class="tocitem" href="../../api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">(Electromagnetic) Theory</a></li><li class="is-active"><a href>Interpolation of Spherically Sampled Data</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Interpolation of Spherically Sampled Data</a></li></ul></nav><div class="docs-right"><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="interpolation_theory"><a class="docs-heading-anchor" href="#interpolation_theory">Interpolation of Spherically Sampled Data</a><a id="interpolation_theory-1"></a><a class="docs-heading-anchor-permalink" href="#interpolation_theory" title="Permalink"></a></h1><p>Consider a function <span>$f(\vartheta, \varphi)$</span> defined on the surface of a sphere, which is sampled at a discrete set of sampling points <span>$(\vartheta_m, \varphi_n)$</span> with <span>$0\leq \vartheta_m \leq \pi$</span>, <span>$0 \leq \varphi_n &lt; 2\pi$</span>, <span>$m=1,\ldots, N_\vartheta$</span>, <span>$n=1,\ldots, N_\varphi$</span>. The sampling points are illustrated below.</p><figure>
<picture>
  <source media="(prefers-color-scheme: dark)" srcset="../assets/sampling_regular_interp_darkmode.svg" width="200">
  <source media="(prefers-color-scheme: light)" srcset="../assets/sampling_regular_interp_darkmode.svg" width="200" >
  <img alt="" src="" width="200">
</picture>

  <figcaption>
    Illustration of the sampling points for the sampled function on the sphere. 
  </figcaption>
</figure>
<br/><p>In many circumstances, we need to evaluate the function <span>$f(\vartheta, \varphi)$</span> at angles <span>$(\vartheta, \varphi)$</span> which do not coincide with any of the stored data points <span>$f(\vartheta_m, \varphi_n)$</span>. In this case, we must perform an interpolation of the data to the desired location.  As long as the data is sampled on closed rings with constant <span>$\vartheta$</span> or constant <span>$\varphi$</span> <sup class="footnote-reference"><a id="citeref-1" href="#footnote-1">[1]</a></sup> , respectively, one can perform the interpolation as a sequence of 1D interpolations along <span>$\vartheta$</span> and <span>$\varphi$</span>. Two closed rings with constant <span>$\vartheta$</span> or constant <span>$\varphi$</span> are illustrated below.</p><figure>
<picture>
  <source media="(prefers-color-scheme: dark)" srcset="../assets/sampling_regular_interp_darkmod_highlighted.svg" width="200">
  <source media="(prefers-color-scheme: light)" srcset="../assets/sampling_regular_interp_darkmod_highlighted.svg" width="200" >
  <img alt="" src="" width="200">
</picture>

  <figcaption>
    Illustration of sampled data on closed rings with constant Theta (green) or constant Phi (red). 
  </figcaption>
</figure>
<br/><p>In the following, we will only outline the 1D interpolation procedures for <span>$2\pi$</span>-periodic functions. We will distinguish between <em>global interpolation</em>, i.e., an interpolation scheme which uses all available data points along a closed ring (i.e., a ring with either a fixed <span>$\vartheta$</span>-coordinate or a fixed <span>$\varphi$</span>-coordinate), and <em>local interpolation</em>, i.e. an interpolation scheme which utlizes only a few sampling points in the neighbourhood of the desired function input.</p><h2 id="Global-Interpolation"><a class="docs-heading-anchor" href="#Global-Interpolation">Global Interpolation</a><a id="Global-Interpolation-1"></a><a class="docs-heading-anchor-permalink" href="#Global-Interpolation" title="Permalink"></a></h2><p>Global interpolation leverages on the fact that any band limited <span>$2\pi$</span>-periodic function <span>$f(\vartheta)$</span> may be expressed via</p><p class="math-container">\[f(\vartheta)
=
\sum
\limits_{k=-B}^{B}
c_k \, \mathrm{e}^{\,\mathrm{j} k \theta}\, .\]</p><p>If we have at least <span>$J_\vartheta = 2B+1$</span> sampling points on the ring, we can, in principle, reconstruct all coefficients <span>$c_k$</span>. From the reconstructed coefficients <span>$c_k$</span> one could calculate the function <span>$f(\vartheta)$</span> at any arbitrary angle <span>$\vartheta$</span> using the equation above.</p><p>If the <span>$J_\vartheta$</span> input sampling points are equidistantly spaced, we can use an FFT to calculate the coefficients <span>$c_k$</span> with <span>$\mathcal{O}(J_\vartheta \log J_\vartheta)$</span> computational complexity. The calculation of the new function value from the coefficients <span>$c_k$</span> requires an additional <span>$\mathcal{O}(J_\vartheta)$</span> operations, such that the overall interpolation process is completely governed by the computional cost of the FFT.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The computational complexity of the interpolation of <strong>equidistantly sampled periodic data</strong> is <span>$\mathcal{O}(J_\vartheta \log J_\vartheta)$</span> because it is determined by the cost of an FFT. </p></div></div><hr/><p>If we further want to interpolate the function <span>$f(\vartheta)$</span> at <span>$J_\vartheta&#39;$</span> equidistantly spaced new points, we can fill zeros into the array containing the coefficients <span>$c_k$</span> such thath the length of the array matches the desired number of sampling points. All of the new function values can be obtained at once from the zero-padded vector of coefficients <span>$c_k$</span> with a single IFFT, such that the resulting sampling points  can be computed in <span>$\mathcal{O}(J_\vartheta&#39; \log J_\vartheta&#39;)$</span> computational complexity.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>If we want to interpolate the function <span>$f(\vartheta)$</span> at <span>$J_\vartheta&#39;$</span> <strong>equidistantly spaced new points</strong> from sampled data at  <span>$J_\vartheta$</span> <strong>equidistantly spaced old sample</strong> points <span>$f(\vartheta_n)$</span>, the computational cost is <span>$\mathcal{O}(J_\vartheta \log J_\vartheta) + \mathcal{O}(J_\vartheta&#39; \log J_\vartheta&#39;)$</span> </p></div></div><hr/><p>However, depending on the <code>SphereSamplingStrategy</code>, the sampling points may or may not be equidistantly spaced. For Non-equidistantly spaced sampling grids, we can use the Barycentric Trigonometric Interpolation formula<sup class="footnote-reference"><a id="citeref-2" href="#footnote-2">[2]</a></sup></p><p class="math-container">\[f(\vartheta) = 
\dfrac{\sum \limits_{k=1}^{J_\vartheta} \dfrac{w_k}{\sin\left(\frac{1}{2} (\vartheta -\vartheta_k) \right)}\, f(\vartheta_k)}{\sum \limits_{k=1}^{J_\vartheta} \dfrac{w_k}{\sin\left(\frac{1}{2} (\vartheta -\vartheta_k )\right)}}\, ,\]</p><p>where </p><p class="math-container">\[w_k= 
\dfrac{1}{\prod \limits_{i\neq k} \sin\left(\frac{1}{2} (\vartheta_k -\vartheta_i )\right)};
  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~i =1, \ldots, N_\vartheta\,.\]</p><p>This interpolation formula is also valid for non-equidistantly spaced sampling points <span>$\vartheta_k$</span>. </p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>This interpolation formula is only valid for odd <span>$J_\vartheta$</span>. If we have an even number of irregularly spaced sampling points <span>$J_\vartheta$</span>, it is recommended to discard one of the sampling points.</p></div></div><hr/><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Note that the barycentric trigonometrc interpolation formula takes the form <span>$f(\vartheta) = \sum_{k=1}^{J_\vartheta} \alpha_k\, f(\vartheta_k)$</span>. With predefined interpolation weights <span>$\alpha_k$</span> the computational cost of evaluating the global interpolation is <span>$\mathcal{O}(J_\vartheta)$</span>, i.e., the computational cost depends on the size of the input data.</p></div></div><hr/><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>If we want to interpolate the function <span>$f(\vartheta)$</span> at <span>$J_\vartheta&#39;$</span> new points, we need to evaluate the barycentric trigonometrc interpolation formula <span>$J_\vartheta&#39;$</span> times, leading to a computational cost of <span>$\mathcal{O}(J_\vartheta \,J_\vartheta&#39;)$</span>. </p></div></div><hr/><p>For bandlimited functions <span>$f(\vartheta)$</span>, global interpolation should be exact (neglecting rounding errors).</p><h2 id="Local-Interpolation"><a class="docs-heading-anchor" href="#Local-Interpolation">Local Interpolation</a><a id="Local-Interpolation-1"></a><a class="docs-heading-anchor-permalink" href="#Local-Interpolation" title="Permalink"></a></h2><p>In certain situations, it is not feasible to have the computational cost of the interpolation to be dependent on the size of the input data. In these cases, we rely on local (polynomial) interpolation <sup class="footnote-reference"><a id="citeref-3" href="#footnote-3">[3]</a></sup> <sup class="footnote-reference"><a id="citeref-4" href="#footnote-4">[4]</a></sup>. </p><p>While global polynomial interpolation fits a polynomial to the entire data on the ring (thus, taking into account all available data points), local interpolation fits a specified order polynomial (fourth order, fifth order, sixth order, ... etc.) using only points in the adjacient neighbourhood of the desired function input <span>$\vartheta_{\mathrm{new}}$</span>. For example, a sixth-order local interpolation would fit a sixth order polynomial through the three sample points before and after <span>$\vartheta_{\mathrm{new}}$</span>. In general, a <span>$K$</span>-order local polynomial will utilize the adjacient <span>$K$</span> data points to interpolate the function <span>$f(\vartheta)$</span> at the new input <span>$\vartheta$</span>. The situation is illustrated below.</p><figure>
<picture>
  <source media="(prefers-color-scheme: dark)" srcset="../assets/local_interp_1Dcircle.svg" width="300">
  <source media="(prefers-color-scheme: light)" srcset="../assets/local_interp_1Dcircle.svg" width="300" >
  <img alt="" src="" width="300">
</picture>

  <figcaption>
    To interpolate the function at the green location, from all available data points (faint orange) only the highlighted sample points (solid red) are utilized for the interpolating polynomial.
  </figcaption>
</figure>
<br/<p>We have <sup class="footnote-reference"><a id="citeref-4" href="#footnote-4">[4]</a></sup></p><p class="math-container">\[f(\vartheta) \approx
\dfrac{\sum \limits_{k=1}^{K} \dfrac{w_k}{\vartheta - \vartheta_k}\, f(\vartheta_k)}{\sum \limits_{k=1}^{K} \dfrac{w_k}{\vartheta - \theta_k}}\]</p><p>where <span>$\vartheta_k$</span> are the <span>$K$</span> old sampling points in the neighbourhood of <span>$\vartheta$</span> and</p><p class="math-container">\[w_k= 
\dfrac{1}{\prod \limits_{i\neq k}  (\vartheta_k -\vartheta_i )};
  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~i =1, \ldots, K\,.\]</p><p>This interpolation formula is also valid for equidistantly and non-equidistantly spaced sampling points <span>$\vartheta_k$</span>.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Note that the local interpolation formula takes the form <span>$f(\vartheta) = \sum_{k=1}^{K} \alpha_k\, f(\vartheta_k)$</span>. With predefined interpolation weights <span>$\alpha_k$</span> the computational cost of evaluating the global interpolation is <span>$\mathcal{O}(K)$</span>, i.e., the computational cost <em>does not dependd on the size of the input data</em>.</p></div></div><hr/><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>If we want to interpolate the function <span>$f(\vartheta)$</span> at <span>$J_\vartheta&#39;$</span> new points, we need to evaluate the local interpolation formula <span>$J_\vartheta&#39;$</span> times, leading to a computational cost of <span>$\mathcal{O}(K \,J_\vartheta&#39;)$</span>. </p></div></div><hr/><p>Although local interpolation is not exact for bandlimited functions <span>$f(\vartheta)$</span>, the approximation error can be controlled by </p><ul><li>oversampling of the original data (i.e., the data is originally stored with more samplng points than required by the Nyquist critereon for recovery of the underlying bandlimited function)</li><li>increasing the degree of the interpolating polynomial</li></ul><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-1"><a class="tag is-link" href="#citeref-1">1</a>For an equidistant sampling along the <span>$\varphi$</span>-direction, this requires an even number of <span>$\varphi$</span>-samples <span>$N_\varphi$</span> such that the <span>$\vartheta$</span>-rings can be interpolated over the poles.</li><li class="footnote" id="footnote-2"><a class="tag is-link" href="#citeref-2">2</a>Berrut, Jean -Paul. &quot;Baryzentrische Formeln zur trigonometrischen Interpolation (I).&quot; Zeitschrift für angewandte Mathematik und Physik ZAMP 35 (1984): 91-105 <a href="https://doi.org/10.1007/BF00945179">DOI. 10.1007/BF00945179</a></li><li class="footnote" id="footnote-3"><a class="tag is-link" href="#citeref-3">3</a>Trefethen, L. &quot;Six myths of polynomial interpolation and quadrature.&quot; (2011). <a href="https://people.maths.ox.ac.uk/trefethen/mythspaper.pdf">University of Oxford</a></li><li class="footnote" id="footnote-4"><a class="tag is-link" href="#citeref-4">4</a>Berrut, Jean-Paul, and Lloyd N. Trefethen. &quot;Barycentric lagrange interpolation.&quot; SIAM review 46.3 (2004): 501-517. <a href="https://epubs.siam.org/doi/abs/10.1137/S0036144502417715">DOI. 10.1137/S003614450241771</a></li></ul></section></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../mlfmm/mlfmm_theory/">« Multilevel Fast Multipole Method</a><a class="docs-footer-nextpage" href="../../api/">API »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.0 on <span class="colophon-date" title="Tuesday 28 January 2025 22:32">Tuesday 28 January 2025</span>. Using Julia version 1.11.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
